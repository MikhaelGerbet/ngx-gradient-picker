<div class="popover-container">
  <!-- Trigger button -->
  <button 
    type="button"
    class="popover-trigger"
    [class.open]="isOpen()"
    [disabled]="disabled()"
    [style.background]="triggerGradientCSS()"
    (click)="toggle()">
    <span class="trigger-overlay"></span>
  </button>

  <!-- Popover content -->
  @if (isOpen()) {
    <!-- Backdrop for bottom-sheet mode -->
    @if (effectivePosition() === 'bottom-sheet') {
      <div class="popover-backdrop" (click)="close()"></div>
    }
    <div class="popover-content" [class]="'position-' + effectivePosition()">
      <!-- Close handle for bottom-sheet -->
      @if (effectivePosition() === 'bottom-sheet') {
        <div class="bottom-sheet-handle" (click)="close()">
          <span class="handle-bar"></span>
        </div>
      }
      <ngx-gradient-picker
        #picker
        [(palette)]="palette"
        [(type)]="type"
        [(angle)]="angle"
        [width]="width()"
        [paletteHeight]="paletteHeight()"
        [minStops]="minStops()"
        [maxStops]="maxStops()"
        [direction]="direction()"
        [showAnglePicker]="showAnglePicker()"
        [showTypePicker]="showTypePicker()"
        [disabled]="disabled()"
        (colorStopSelect)="onStopSelect($event)">
        <ng-content></ng-content>
      </ngx-gradient-picker>
    </div>
  }
</div>
